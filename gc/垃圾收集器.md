## 垃圾判断算法

* 引用计数算法：效率高，但是无法解决循环引用的问题
* 可达性分析算法：以GCRoot为根部，通过引用关系链向下搜索，如果某一个对象无法被搜索到，则说明改对象没有被引用
  * 哪些被称为gc root
    * 栈帧中引用的对象，譬如参数，局部变量，临时变量等；
    * 方法区中类**静态属性引用**的对象，如java类的引用类型静态变量；
    * 方法区中**常量引用**的对象，譬如字符串常量池（String Table）里的引用；
    * 本地方法栈中JNI引用的对象；
    * 虚拟机引用对象，基础类型的class对象、常驻异常对象、系统类加载器；
    * 同步锁持有的对象；

## 垃圾收集算法

* 分代收集理论
  * 强分代假说：熬过越多次垃圾对象收集过程的对象就越难以消亡
  * 弱分代假说：绝大多数的对象朝生夕灭
  * 跨代引用假说：跨代引用对于同代引用是占用极少数的（记忆集 建立在新生代全局的数据结构，标记了老年代哪一块内存会存在跨代引用）
* 标记-清除算法
  * 执行效率不稳定；如果存在大量的对象，必须进行大量的标记和清除的动作，导致标记和清除两个过程都随对象数量增长而降低；
  * 空间碎片化的问题；标记和清除过后容易产生大量不连续的内存碎片，不能存放大对象后又提前触发垃圾收集的动作；
* 标记-复制算法
  * 解决清除算法导致的空间碎片问题，速度高效；
  * 内存空间缩小了原来的一半，内存空间浪费多；
* 标记-整理算法
  * 和标记清除差不多，但是这个是移动式的，每次移动都会存在stw，但是如果不移动只能依赖更为复杂的内存分配链表

关注延迟的cms收集器 基于标记清除的-但是没有空间后还是会进行整理一次；

Paraller-scavenge更加关注于吞吐量，内存分配和访问相比垃圾收集频率要高很多，垃圾收集的耗时增加，总吞吐量还是下降的。吞吐量 = 运行用户代码时间 / (运行用户代码时间+垃圾收集时间) 和parnew对比也就是更加关注停顿时间，可以单独设置这个



|     名称     | 作用域  |   算法   | 线程 | gc时候是否需要stw | 参数                                                         |
| :----------: | :-----: | :------: | ---- | ----------------- | ------------------------------------------------------------ |
| Serial收集器 | 年轻代  | 复制算法 | 单   | 是                | -XX:+UseSerialGC                                             |
| ParNew收集器 | 年轻代  | 复制算法 | 多   | 是                | -XX:+UseConcMarkSweepGC：指定使用CMS后，会默认使用ParNew作为新生代收集器<br />-XX:+UseParNewGC：强制指定使用ParNew<br />-XX:ParallelGCThreads：指定垃圾收集的线程数量，ParNew默认开启的收集线程与CPU的数量相同 |
|   Paraller   | 年轻代  | 复制算法 | 多   | 是                | -XX:MaxGCPauseMillis：系统GC的停顿时间<br />-XX:GCTimeRatio：垃圾收集时间占总时间的比率<br />-XX:+UseAdaptiveSizePolicy：打开后，不需要手工指定新生代的大小，GC自适应的调节策略 |
|  Serial Old  | 老年代  | 整理算法 | 单   | 是                | 与Serial收集器、Parallel收集器搭配使用<br />作为CMS收集器的后备方案 |
| Parallel Old | 老年代  | 整理算法 | 多   | 是                |                                                              |
|  CMS收集器   | 老年代  | 清除算法 | 多   | 部分              |                                                              |
|   G1收集器   | mix混合 | 整理算法 | 多   | 部分              |                                                              |

